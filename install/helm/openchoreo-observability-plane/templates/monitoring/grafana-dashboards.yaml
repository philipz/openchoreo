{{- if and .Values.monitoring.dashboards.enabled ( .Files.Glob "config/observability/grafana/dashboards/*.json" ) }}
{{- $files := .Files.Glob "config/observability/grafana/dashboards/*.json" }}
{{- range $path, $file := $files }}
{{- $fileName := base $path }}
{{- $cmSuffix := replace "." "-" $fileName }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "openchoreo-observability-plane.fullname" $ }}-{{ $cmSuffix }}-dashboard
  namespace: {{ $.Release.Namespace }}
  labels:
    {{- include "openchoreo-observability-plane.componentLabels" (dict "context" $ "component" "grafana-dashboard") | nindent 4 }}
    grafana_dashboard: "1"
data:
  {{ $fileName }}: |
{{ printf "%s" $file | indent 4 }}
{{- end }}
{{- end }}
